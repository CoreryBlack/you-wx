"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("./common/vendor.js"),r=require("./store/index.js"),n=require("./api/modules/auth.js");require("./utils/http.js");const t=require("./store/modules/app.js"),a=require("./store/modules/user.js");Math;const o={onLaunch(){t.useAppStore().initSystemInfo();const e=a.useUserStore();this.autoLogin(e),this.hideTabBar()},onShow(){this.hideTabBar()},onHide(){},methods:{async autoLogin(r){var t;try{const a=await e.index.login({provider:"weixin"}),o=Array.isArray(a)?null==(t=a[1])?void 0:t.code:a.code;if(!o)return;const i=await n.wxLogin({code:o},{silent:!0});if(i&&i.needBind){i.openId&&e.index.setStorageSync("wx_temp_openId",i.openId);const n=i.user||i.userInfo||i.data||null;if(n){const t={nickName:n.nickname||n.nickName||"",avatarUrl:n.avatar_url||n.avatarUrl||"",phone:n.phone||""};e.index.setStorageSync("wx_temp_user",t),r.setUserInfo(t)}return}if(i&&i.token){const e=i.user||i.userInfo||{},n={...e,userId:e.user_id||e.userId||e.id||"",nickName:e.nickname||e.nickName||"",avatarUrl:e.avatar||e.avatar_url||e.avatarUrl||""};r.login({token:i.token,userInfo:n})}}catch(a){}},hideTabBar(){try{void 0!==e.index&&"function"==typeof e.index.hideTabBar&&e.index.hideTabBar({fail:e=>{}})}catch(r){}}}};function i(){const n=e.createSSRApp(o);return n.use(r.pinia),n.use(e.uView),{app:n}}i().app.mount("#app"),exports.createApp=i;
